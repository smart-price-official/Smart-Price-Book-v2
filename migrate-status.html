<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>Smart Price｜Migration Status</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
  body {
    margin: 0;
    font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    background: #111;
    color: #eee;
  }
  header {
    background: #b71c1c;
    padding: 12px 16px;
    font-weight: bold;
  }
  main {
    padding: 16px;
  }
  button {
    display: block;
    width: 100%;
    margin: 12px 0;
    padding: 14px;
    font-size: 16px;
    border: none;
    border-radius: 8px;
    background: #333;
    color: #fff;
    cursor: pointer;
  }
  button.primary {
    background: #c62828;
  }
  pre {
    background: #000;
    padding: 12px;
    border-radius: 8px;
    max-height: 40vh;
    overflow: auto;
    font-size: 13px;
  }
</style>
</head>

<body>
<header>
  Smart Price / Migration Status
</header>

<main>
  <button class="primary" onclick="scanDB()">① 既存データを確認する</button>
  <button onclick="exportJSON()">② IndexedDB を JSON で表示</button>
  <pre id="log">ここに結果が表示されます</pre>
</main>

<script>
async function scanDB() {
  const out = [];
  if (!indexedDB.databases) {
    out.push("このブラウザでは indexedDB.databases() が使えません");
  } else {
    const dbs = await indexedDB.databases();
    if (!dbs.length) out.push("IndexedDB は空です");
    dbs.forEach(db => {
      out.push(`DB: ${db.name} (ver ${db.version})`);
    });
  }
  log(out.join("\n"));
}

function exportJSON() {
  log("※ この画面は確認用です\n実データの export は migrate-tool.html 側で行います");
}

function log(text) {
  document.getElementById("log").textContent = text;
}
</script>
</body>
</html>

